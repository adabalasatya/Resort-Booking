(()=>{var e={};e.id=977,e.ids=[977],e.modules={6037:e=>{"use strict";e.exports=require("mongoose")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},4573:e=>{"use strict";e.exports=require("node:buffer")},7598:e=>{"use strict";e.exports=require("node:crypto")},7975:e=>{"use strict";e.exports=require("node:util")},1210:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=t(260),i=t(8203),n=t(5155),o=t.n(n),a=t(7292),l={};for(let e in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);t.d(r,l);let d=["",{children:["(user)",{children:["invoice",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8948)),"C:\\Users\\pardh\\OneDrive\\Desktop\\Next_Resort\\src\\app\\(user)\\invoice\\page.jsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,2804)),"C:\\Users\\pardh\\OneDrive\\Desktop\\Next_Resort\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\pardh\\OneDrive\\Desktop\\Next_Resort\\src\\app\\(user)\\invoice\\page.jsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/(user)/invoice/page",pathname:"/invoice",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},812:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,3219,23)),Promise.resolve().then(t.t.bind(t,4863,23)),Promise.resolve().then(t.t.bind(t,5155,23)),Promise.resolve().then(t.t.bind(t,9350,23)),Promise.resolve().then(t.t.bind(t,6313,23)),Promise.resolve().then(t.t.bind(t,8530,23)),Promise.resolve().then(t.t.bind(t,8921,23))},4364:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6959,23)),Promise.resolve().then(t.t.bind(t,3875,23)),Promise.resolve().then(t.t.bind(t,8903,23)),Promise.resolve().then(t.t.bind(t,4178,23)),Promise.resolve().then(t.t.bind(t,6013,23)),Promise.resolve().then(t.t.bind(t,7190,23)),Promise.resolve().then(t.t.bind(t,1365,23))},9323:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,5197,23)),Promise.resolve().then(t.bind(t,6981))},6115:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,7801,23)),Promise.resolve().then(t.bind(t,8073))},5507:()=>{},2459:()=>{},8073:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var s=t(5512),i=t(8009);let n=({userId:e})=>{let[r,t]=(0,i.useState)(null),[n,o]=(0,i.useState)(!0),[a,l]=(0,i.useState)(null);console.log("extractId:",e);let d=async()=>{try{let r=await fetch(`http://localhost:3000/api/users/${e}`),s=await r.json();if(console.log("newData:",s),r.ok)t(s.data);else throw Error(s.message||"Failed to fetch invoice data")}catch(e){l(e.message),console.log(e)}finally{o(!1)}};if((0,i.useEffect)(()=>{d()},[d]),n)return(0,s.jsx)("div",{children:"Loading..."});if(a)return(0,s.jsxs)("div",{children:["Error: ",a]});if(!r||!r.bookings)return(0,s.jsx)("div",{children:"No invoice data available"});let c=(e,r)=>{let t=new Date(e);return Math.ceil(Math.abs(new Date(r)-t)/864e5)},u=async e=>{if(window.confirm("Are you sure to delete this booking?"))try{let r=await fetch(`http://localhost:3000/api/users/${e}`,{method:"DELETE"}),s=await r.json();if(r.ok)t(r=>({...r,bookings:r.bookings.filter(r=>r._id!==e)})),console.log("Booking deleted:",s);else throw Error(s.message||"Failed to delete booking")}catch(e){console.error("Error deleting booking:",e),alert("Failed to delete booking")}};return(0,s.jsxs)("div",{className:"invoice-container",children:[(0,s.jsxs)("h1",{children:["Username: ",r.username]}),r.bookings.length>0?r.bookings.map(e=>{let r=c(e.startDate,e.endDate),t=r*e.price;return(0,s.jsxs)("div",{className:"booking-item",children:[(0,s.jsx)("h3",{children:e.productName}),(0,s.jsxs)("p",{children:["Booking dates from ",e.startDate," to ",e.endDate]}),(0,s.jsxs)("p",{children:["Discount: ",e.offer,"%"]}),(0,s.jsxs)("p",{children:["Number of Days: ",r]}),(0,s.jsxs)("h4",{children:["Price per day: ",e.price]}),(0,s.jsxs)("h4",{children:["Total Amount: ",t]}),(0,s.jsx)("div",{align:"center",children:(0,s.jsx)("button",{onClick:()=>u(e._id),className:"deleteBtn",children:"Delete Booking"})})]},e._id)}):(0,s.jsx)("div",{className:"no-bookings",children:"No bookings available"})]})}},8948:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(2740),i=t(3636),n=t(6981),o=t(3720),a=t(6794);t(6301);let l=async()=>{let e=await (0,i.j2)(),r=e.email,t=await a.A.findOne({email:r}),l=t?._id.toString(),d=t?.bookings.length||0;return console.log("userId:",l),(0,s.jsxs)("div",{children:[(0,s.jsx)(o.A,{userName:e.username,bookingCount:d}),(0,s.jsx)(n.default,{userId:l})]})}},3636:(e,r,t)=>{"use strict";t.d(r,{LO:()=>c,fG:()=>d,j2:()=>o});var s=t(6414),i=t(1648),n=t(6794);let{auth:o,signIn:a,signOut:l,handlers:{GET:d,POST:c}}=(0,s.Ay)({providers:[(0,i.A)({name:"credentials",async authorize(e){let r=await n.A.findOne({email:e?.email});return r&&e?.password===r.password?{name:r.username,email:r.email,role:r.role}:null}})],secret:process.env.SECRET_KEY,callbacks:{jwt:async({token:e,user:r})=>(r&&(e.userId=r.id,e.username=r.name,e.role=r.role,e.email=r.email),e),session:async({session:e,token:r})=>(e.userId=r.userId,e.username=r.username,e.role=r.role,e.email=r.email,e)}})},6981:(e,r,t)=>{"use strict";t.d(r,{default:()=>s});let s=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\pardh\\\\OneDrive\\\\Desktop\\\\Next_Resort\\\\src\\\\app\\\\components\\\\UserInvoice.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\pardh\\OneDrive\\Desktop\\Next_Resort\\src\\app\\components\\UserInvoice.jsx","default")},3720:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var s=t(2740),i=t(308);t(6301);var n=t(82);let o=({userName:e})=>(0,s.jsxs)("div",{className:"navSection",children:[(0,s.jsxs)("div",{className:"navLinks",children:[(0,s.jsx)(i.default,{href:"/",className:"link",children:(0,s.jsx)("h2",{children:"Home"})}),(0,s.jsx)(i.default,{href:"/invoice",className:"link",children:(0,s.jsx)("h2",{children:"Your Bookings"})})]}),(0,s.jsxs)("p",{className:"welcomeMessage",children:["Welcome:",(0,s.jsx)("span",{style:{color:"red",marginLeft:"5px",fontSize:"1.2rem"},children:e})]}),(0,s.jsxs)("div",{className:"navLinks",children:[(0,s.jsxs)("div",{className:"contactIcons",children:[(0,s.jsx)(i.default,{href:"https://twitter.com",target:"_blank",className:"icon",children:(0,s.jsx)(n.feZ,{})}),(0,s.jsx)(i.default,{href:"mailto:satya1adabala@gmail.com",className:"icon",children:(0,s.jsx)(n.maD,{})}),(0,s.jsx)(i.default,{href:"tel:9515432936",className:"icon",children:(0,s.jsx)(n.dRU,{})})]}),(0,s.jsx)(i.default,{href:"/api/auth/signout",className:"link",children:(0,s.jsx)("div",{className:"logout",children:"Logout"})})]})]})},2804:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a,metadata:()=>o});var s=t(2740),i=t(1081),n=t.n(i);t(1135);let o={title:"Next Holiday Resort",description:"Generated by create next app"};function a({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:n().className,children:e})})}},6794:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let{default:s,mongo:i}=t(6037),n=new s.Schema({username:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,default:"user"},bookings:[{type:s.Schema.Types.ObjectId,ref:"booking"}]}),o=s.models.user||s.model("user",n)},440:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(8077);let i=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},1135:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[989,187,840,205,173,61],()=>t(1210));module.exports=s})();